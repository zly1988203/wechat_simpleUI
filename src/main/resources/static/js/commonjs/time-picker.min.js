!function(){"use strict";var e=function(e){return e>9?e:"0"+e},i=function(e,i){var t=Math.round(-e.y/36+2);$(i).find("li").eq(t).addClass("selected").siblings().removeClass("selected")},t={},l=!0,a=function(e,a,r){a.length<=0&&(a=$(e).find("li:eq(2)"));var n=e.replace(/^\.picker\-/,""),u=new IScroll(e,{vScrollbar:!1,momentum:!0,bounce:!0,probeType:3});t[n]=u,u.on("scrollStart",function(){l=!1},{passive:!1}),u.on("scroll",function(){i(this,e),".picker-day"===e&&$(".picker-hour ul").animate({translate:"0, 0px"},"fast","linear")});var c={day:$(e).parents(".picker-container").find(".picker-day"),hour:$(e).parents(".picker-container").find(".picker-hour"),minute:$(e).parents(".picker-container").find(".picker-minute")};if(u.on("scrollEnd",function(){setTimeout(function(){i(this,e);var a=Math.round(-this.y/36+2);if(a-=2,$(e+" ul").animate({translate:"0, -"+36*a+"px"},"fast","linear"),".picker-day"===e&&$(".picker-hour ul").animate({translate:"0, 0px"},"fast","linear"),$.isFunction(r)){var u={day:$(".picker-day li.selected").data("value"),hour:$(".picker-hour li.selected").data("value"),minute:$(".picker-minute li.selected").data("value")};r(u,n,c,t)}l=!0},500)}),a.addClass("selected").siblings().removeClass("selected"),u.scrollToElement(a.prev().prev()[0],0),$.isFunction(r)){var o={day:$(".picker-day li.selected").data("value"),hour:$(".picker-hour li.selected").data("value"),minute:$(".picker-minute li.selected").data("value")};r(o,n,c,t)}return u};$.timePicker=function(i,t){"function"==typeof i&&(t=arguments[0],i=void 0);var r=[],n=new Date;$.each(["今天","明天","后天"],function(i,t){r.push({text:t,value:n.getFullYear()+"-"+e(n.getMonth()+1)+"-"+e(n.getDate())}),n.setDate(n.getDate()+1)});for(var u=[],c=0;c<=23;c++)u.push({text:(c<=9?"0"+c:c)+"点",value:c});var o=[];for(c=0;c<=50;c+=10)o.push({text:(c<=9?"0"+c:c)+"分",value:c});i=$.extend({title:"请选择时间",day:r,hour:u,minute:o,data:{day:"今天",hour:8,minute:30},onChange:null},i);var p=$(doT.template('<div id="timer-picker-popup" class="sui-popup-container"><div class="sui-popup-mask"></div><div class="sui-popup-modal"><div class="toolbar-inner"><button class="sui-cancel" type="button">取消</button><span>{{=it.title}}</span><button class="sui-ok" type="button">确定</button></div><ul class="picker-container"><li class="picker-col-wrapper"><div class="picker-control picker-day"><ul><li></li><li></li>{{~it.day:d}}<li data-value="{{=d.value}}">{{=d.text}}</li>{{~}}<li></li><li></li></ul></div></li><li class="picker-col-wrapper"><div class="picker-control picker-hour"><ul><li></li><li></li>{{~it.hour:d}}<li data-value="{{=d.value}}">{{=d.text}}</li>{{~}}<li></li><li></li></ul></div></li><li class="picker-col-wrapper"><div class="picker-control picker-minute"><ul><li></li><li></li>{{~it.minute:d}}<li data-value="{{=d.value}}">{{=d.text}}</li>{{~}}<li></li><li></li></ul></div></li></ul><div class="picker-center-highlight sui-border-tb"></div></div></div>')(i)).appendTo(document.body);$("#timer-picker-popup").popup("plate");var d=i.data,s=a(".picker-day",$('.picker-day li[data-value="'+d.day+'"]'),i.onChange),v=a(".picker-hour",$('.picker-hour li[data-value="'+d.hour+'"]'),i.onChange),k=a(".picker-minute",$('.picker-minute li[data-value="'+d.minute+'"]'),i.onChange);p.find(".sui-mask,.sui-cancel").on("click",function(){$("#timer-picker-popup").closePopup(function(){s.destroy(),v.destroy(),k.destroy(),s=null,v=null,k=null,$("#timer-picker-popup").remove()})}),p.find(".sui-ok").on("click",function(){if(l){var e={day:$(".picker-day li.selected").data("value"),hour:$(".picker-hour li.selected").data("value"),minute:$(".picker-minute li.selected").data("value")},i={day:$(".picker-day li.selected").text(),hour:$(".picker-hour li.selected").text(),minute:$(".picker-minute li.selected").text()};$("#timer-picker-popup").closePopup(function(){$.isFunction(t)&&t(e,i),s.destroy(),v.destroy(),k.destroy(),s=null,v=null,k=null,$("#timer-picker-popup").remove()})}})}}(Zepto);